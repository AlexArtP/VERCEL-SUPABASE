---
title: Flujo de Integración Next.js (Vercel) + Firebase (Auth, Firestore)
---
flowchart TD
    A[Usuario accede a la app en Vercel] --> B[Next.js renderiza página (SSR/SSG/API)]
    B --> C{¿Requiere datos protegidos?}
    C -- Sí --> D[Next.js consulta Firestore vía SDK cliente]
    D --> E{¿Usuario autenticado?}
    E -- Sí --> F[Firestore permite acceso según reglas]
    E -- No --> G[Firestore deniega acceso]
    C -- No --> H[Next.js muestra contenido público]
    F --> I[Datos mostrados en UI]
    G --> J[UI muestra error de permisos]
    H --> I
    I --> K{¿Acción de usuario?}
    K -- Login --> L[Next.js usa Firebase Auth SDK]
    L --> M[Usuario autenticado en Firebase]
    M --> D
    K -- Registro --> N[Next.js usa Firebase Auth SDK]
    N --> O[Usuario registrado en Firebase]
    O --> M
    K -- CRUD (citas, módulos, etc) --> P[Next.js llama API route (SSR) o Firestore directo]
    P --> D
    subgraph Vercel
      A
      B
      C
      H
      K
      L
      N
      P
    end
    subgraph Firebase
      D
      E
      F
      G
      M
      O
    end
    subgraph UI
      I
      J
    end
